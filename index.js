const port = process.env.SERVER_PORT || process.env.PORT || 3000;
const vmms = process.env.VPATH || 'vls-123456';
const vmmport = process.env.VL_PORT || '8002';
const vmpath = process.env.MPATH || 'vms-3456789';
const vmport = process.env.VM_PORT || '8001';
const xieyi = process.env.XIEYI || 'vms';
const uuid = process.env.UUID || '3a8a1de5-7d41-45e2-88fe-0f538b822169';
const youxuan = process.env.CF_IP || 'ip.sb';
const sub_name = process.env.SUB_NAME || 'node-ws'; // 订阅名称
const sub_url = process.env.SUB_URL || '';
const baohuo = process.env.BAOHUO_URL || ''; // 保活网址
const nezhaser = process.env.NSERVER || '';
const nezhaKey = process.env.NKEY || '';  // 哪吒密钥兼订阅密钥
const nezport = process.env.NPORT || '443';
const neztls = process.env.NTLS || '--tls';
const filePath = process.env.FILE_PATH || '/tmp/';
const tok = process.env.TOK || '';// 隧道token
let host_name = '';
if (tok) {
   host_name = process.env.DOM || '';// 隧道域名
}
const _0x11562a=_0x3ee7;(function(_0x90db54,_0x3ccdf3){const _0x2f31b7=_0x3ee7,_0x5abb8b=_0x90db54();while(!![]){try{const _0x2f6f38=parseInt(_0x2f31b7(0x96))/0x1*(-parseInt(_0x2f31b7(0xbd))/0x2)+parseInt(_0x2f31b7(0x124))/0x3*(parseInt(_0x2f31b7(0xd6))/0x4)+-parseInt(_0x2f31b7(0x123))/0x5+-parseInt(_0x2f31b7(0xff))/0x6*(parseInt(_0x2f31b7(0x112))/0x7)+-parseInt(_0x2f31b7(0x9c))/0x8*(-parseInt(_0x2f31b7(0xd7))/0x9)+-parseInt(_0x2f31b7(0xf0))/0xa+parseInt(_0x2f31b7(0x11d))/0xb;if(_0x2f6f38===_0x3ccdf3)break;else _0x5abb8b['push'](_0x5abb8b['shift']());}catch(_0x21f720){_0x5abb8b['push'](_0x5abb8b['shift']());}}}(_0x4356,0xdf2df));const nezhaHasPort=nezhaser[_0x11562a(0xd2)](':'),crypto=require(_0x11562a(0xad)),seed=''+sub_name+uuid+nezhaser+nezhaKey+tok,hash=crypto[_0x11562a(0x9b)](_0x11562a(0xc3))['update'](seed)['digest'](_0x11562a(0xbe)),AGENT_UUID1=hash[_0x11562a(0xed)](0x0,0x8)+'-'+hash[_0x11562a(0xed)](0x8,0xc)+'-'+hash['substring'](0xc,0x10)+'-'+hash['substring'](0x10,0x14)+'-'+hash[_0x11562a(0xed)](0x14,0x20),AGENT_UUID=process[_0x11562a(0xe0)][_0x11562a(0xc0)]||AGENT_UUID1||'fraewrwdf-das-2sd2-4324-f232df',NEZHA_URL_X64=process[_0x11562a(0xe0)][_0x11562a(0xdc)]||_0x11562a(0x98),NEZHA_URL_ARM64=process[_0x11562a(0xe0)]['NEZHA_URL_ARM64']||_0x11562a(0xb2),NEZHA_URL_BSD=process[_0x11562a(0xe0)][_0x11562a(0x106)]||'https://github.com/Fscarmon/flies/releases/latest/download/agent-freebsd_amd64',NEZHA_URL_X64_ALT=process[_0x11562a(0xe0)][_0x11562a(0xbb)]||_0x11562a(0xb3),NEZHA_URL_ARM64_ALT=process['env']['NEZHA_URL_ARM64_ALT']||'https://github.com/Fscarmon/flies/releases/latest/download/agent2-linux_arm64',NEZHA_URL_BSD_ALT=process[_0x11562a(0xe0)][_0x11562a(0x9d)]||_0x11562a(0xa9),WEB_URL_X64=process[_0x11562a(0xe0)][_0x11562a(0xc6)]||'https://github.com/dsadsadsss/1/releases/download/xry/kano-yuan',WEB_URL_ARM64=process[_0x11562a(0xe0)][_0x11562a(0x8f)]||_0x11562a(0x117),WEB_URL_BSD=process[_0x11562a(0xe0)][_0x11562a(0xf2)]||_0x11562a(0xb0),CFF_URL_X64=process[_0x11562a(0xe0)][_0x11562a(0xc1)]||_0x11562a(0xe2),CFF_URL_ARM64=process['env'][_0x11562a(0xa2)]||_0x11562a(0xa8),CFF_URL_BSD=process[_0x11562a(0xe0)][_0x11562a(0x101)]||_0x11562a(0xab),WEB_FILENAME=process[_0x11562a(0xe0)][_0x11562a(0xf9)]||_0x11562a(0x102),NEZHA_FILENAME=process[_0x11562a(0xe0)]['NEZHA_FILENAME']||_0x11562a(0xf6),CFF_FILENAME=process['env'][_0x11562a(0xce)]||_0x11562a(0x10d),vport=xieyi===_0x11562a(0xcf)?vmport:vmmport,express=require(_0x11562a(0x109)),app=express(),exec=require(_0x11562a(0x119))[_0x11562a(0xd8)],os=require('os'),{createProxyMiddleware}=require(_0x11562a(0xf7)),request=require(_0x11562a(0xc4)),fs=require('fs'),path=require(_0x11562a(0xe1)),axios=require('axios');console['log']('=============================='),console['log'](''),console['log'](_0x11562a(0x125)),console[_0x11562a(0x10b)](_0x11562a(0xe8)),console['log'](_0x11562a(0xfc)+uuid+_0x11562a(0x11b)),console['log'](''),console['log'](_0x11562a(0x10e)),app['get']('/',function(_0x415b69,_0x20a553){const _0x5e5579=_0x11562a;_0x20a553[_0x5e5579(0xa5)](_0x5e5579(0x10f));});function _0x4356(){const _0x1fe5ae=['Process\x20check\x20and\x20start\x20completed','ps\x20aux\x20|\x20grep\x20-E\x20\x22','substring','freebsd','Started','8879390govrvI','curl\x20-s\x20https://ip.xuexi365.eu.org','WEB_URL_BSD','chmod','base64','now','nexus','http-proxy-middleware','post','WEB_FILENAME','name','linux','\x20\x20\x20\x20\x20/','&type=ws&sni=','upload\x20sub_name\x20succeeded','606aiGPsE','application/json','CFF_URL_BSD','webdav','\x20is\x20already\x20running','\x20--no-autoupdate\x20>\x20','http://127.0.0.1:','NEZHA_URL_BSD','response','Error\x20getting\x20host_name:\x20','express','push','log','curl\x20-m5\x20https://','cfloat','==============================','hello\x20world','\x0askip_connection_count:\x20false\x0askip_procs_count:\x20false\x0atemperature:\x20false\x0atls:\x20','pipe','126329KaWXvh','-\x20Data:','use','\x20>/dev/null\x202>&1\x20&','--tls','https://github.com/dsadsadsss/1/releases/download/xry/kano-yuan-arm','Download\x20web\x20successful','child_process','forEach','\x20订阅','listen','50473940JbDFpK','data','SS}','arch','command\x20-v\x20','\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20--no-autoupdate\x20run\x20--token\x20','5503130yCUKLU','11031HctckZ','\x20\x20\x20\x20\x20/info\x20系统信息','config.yml','\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20--url\x20http://localhost:','platform','!\x0a==============================','x64','createWriteStream','nohup\x20','\x20-s\x20','WEB_URL_ARM64','\x20-c\x20','Failed\x20to\x20create\x20config.yml:\x20','/argo.log\x202>&1\x20&','close','PROJECT_DOMAIN','from','2EtMqKd','.glitch.me','https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_amd64','下载文件失败','writeFile','createHash','10256gFsKCV','NEZHA_URL_BSD_ALT','json','Failed\x20to\x20set\x20executable\x20permission\x20for\x20','join','错误:\x20AGENT_UUID\x20环境变量未设置','CFF_URL_ARM64','443','\x22\x20|\x20grep\x20-v\x20\x22grep\x22','send','Failed\x20to\x20check\x20or\x20start\x20nezgix\x20process:\x20','-\x20Status:\x20','https://github.com/Fscarmon/flies/releases/latest/download/cff-linux-arm64','https://github.com/Fscarmon/flies/releases/latest/download/agent2-freebsd_amd64','Sub\x20Upload\x20successful','https://github.com/dsadsadsss/1/releases/download/xry/argo-bsdamd','获取国家名称失败，使用默认值\x22未知\x22','crypto','toString','none','https://github.com/dsadsadsss/1/releases/download/xry/kano-bsd','trim','https://github.com/Fscarmon/flies/releases/latest/download/agent-linux_arm64','https://github.com/Fscarmon/flies/releases/latest/download/agent2-linux_amd64','host_name\x20set\x20to\x20','error','Download\x20nezha\x20successful','client_secret:\x20','length','Sub\x20Upload\x20failed','message','NEZHA_URL_X64_ALT','grep\x20-oE\x20\x22https://.*[a-z]+cloudflare.com\x22\x20','279554nbjxcU','hex','Failed\x20to\x20start','AGENT_UUID','CFF_URL_X64','-\x20No\x20response\x20received\x20for\x20the\x20request.','sha256','request','arm64','WEB_URL_X64','MPATH=','使用国家名称:','Failed\x20to\x20start\x20','nx-app\x20listening\x20on\x20port\x20','vmess://','\x20-p\x20','status','CFF_FILENAME','vms','\x20UUID=','\x20nohup\x20','includes','Download\x20cff\x20failed','{PA','stringify','156YVkbDK','1917lRptYk','exec','upname\x20failed\x20with\x20status:\x20','replace','then','NEZHA_URL_X64','\x20VM_PORT=','Download\x20web\x20failed','://','env','path','https://github.com/Fscarmon/flies/releases/latest/download/cff-linux-amd64','\x20started\x20successfully!','获取国家名称失败:\x20','\x20VPATH=','获取的国家名称为空','/argo.log\x20|\x20tail\x20-n\x201\x20|\x20sed\x20\x22s#https://##\x22','\x20\x20\x20\x20\x20/start\x20检查进程','config.yml\x20created\x20successfully.','Unsupported\x20platform\x20or\x20architecture'];_0x4356=function(){return _0x1fe5ae;};return _0x4356();}let countryCode='未知',up_url='',encodedUrl='';function getCountryName(_0x53dee8){const _0x4cc43c=_0x11562a;exec(_0x4cc43c(0xf1),(_0x59832d,_0x1fb0a9,_0xbb3707)=>{const _0x570b64=_0x4cc43c;if(_0x59832d){console[_0x570b64(0xb5)](_0x570b64(0xe4)+_0xbb3707),_0x53dee8('未知');return;}const _0x5a6a8b=_0x1fb0a9['trim']();_0x5a6a8b&&_0x5a6a8b[_0x570b64(0xb8)]>0x0?_0x53dee8(_0x5a6a8b):(console[_0x570b64(0xb5)](_0x570b64(0xe6)),_0x53dee8('未知'));});}getCountryName(_0x37db13=>{countryCode=_0x37db13;});let lastHostName='',lastSentTime=0x0;function checkHostNameChange(_0x44c219){const _0x364f68=_0x11562a;!tok?exec(_0x364f68(0xbc)+filePath+_0x364f68(0xe7),(_0x5e17c6,_0x2cf0d4,_0x1dd04f)=>{const _0x1f78cb=_0x364f68;if(_0x5e17c6)return console[_0x1f78cb(0xb5)](_0x1f78cb(0x108)+_0x5e17c6),_0x44c219();const _0x527fbe=_0x2cf0d4[_0x1f78cb(0xb1)]();_0x527fbe&&_0x527fbe!==lastHostName&&(console[_0x1f78cb(0x10b)](_0x1f78cb(0xb4)+_0x527fbe),host_name=_0x527fbe,lastHostName=_0x527fbe,buildUrls()),_0x44c219();}):_0x44c219();}function generateVmessLink(){const _0x11799f=_0x11562a,_0x3a60e4={'v':'2','ps':countryCode+'-'+sub_name,'add':youxuan,'port':_0x11799f(0xa3),'id':uuid,'aid':'0','net':'ws','type':_0x11799f(0xaf),'host':host_name,'path':'/'+vmpath+'?ed=2048','tls':'tls','sni':host_name,'alpn':''},_0x1fab73=JSON[_0x11799f(0xd5)](_0x3a60e4);return _0x11799f(0xcb)+Buffer[_0x11799f(0x95)](_0x1fab73)[_0x11799f(0xae)](_0x11799f(0xf4));}function buildUrls(){const _0x413842=_0x11562a;if(xieyi==='vms')up_url=generateVmessLink(),encodedUrl=up_url;else{const _0x523c0d='{PASS}';up_url=_0x523c0d+_0x413842(0xdf)+uuid+'@'+youxuan+':443?path=%2F'+vmms+'%3Fed%3D2048&security=tls&encryption=none&host='+host_name+_0x413842(0xfd)+host_name+'#'+countryCode+'-'+sub_name,up_url=up_url[_0x413842(0xda)](_0x413842(0xd4),'vl')[_0x413842(0xda)](_0x413842(0x11f),'ess'),encodedUrl=Buffer[_0x413842(0x95)](up_url)[_0x413842(0xae)](_0x413842(0xf4));}}function initializeData(){getCountryName(_0x5cc015=>{const _0x52ec20=_0x3ee7;_0x5cc015?(countryCode=_0x5cc015,console[_0x52ec20(0x10b)](_0x52ec20(0xc8),countryCode),checkHostNameChange(()=>{buildUrls();})):(console[_0x52ec20(0xb5)](_0x52ec20(0xac)),countryCode='未知',checkHostNameChange(()=>{buildUrls();}));});}function sendSubscription(){const _0x35a695=_0x11562a,_0x37bde8={'URL_NAME':sub_name,'URL':up_url};axios['post'](sub_url,_0x37bde8,{'headers':{'Content-Type':_0x35a695(0x100)}})[_0x35a695(0xdb)](_0x567c37=>{const _0x1ba156=_0x35a695;console[_0x1ba156(0x10b)](_0x1ba156(0xaa));})['catch'](_0x4c590a=>{const _0x168e47=_0x35a695;console['error'](_0x168e47(0xb9));});}function startCronJob(){!tok?setInterval(()=>{checkHostNameChange(()=>{const _0x5fa01c=_0x3ee7,_0x4d3566=Date[_0x5fa01c(0xf5)]();_0x4d3566-lastSentTime>=0x5*0x3c*0x3e8&&(sendSubscription(),lastSentTime=_0x4d3566);});},0x3c*0x3e8):(buildUrls(),sendSubscription(),setInterval(()=>{const _0x4565ca=_0x3ee7,_0x203f2f=Date[_0x4565ca(0xf5)]();_0x203f2f-lastSentTime>=0x5*0x3c*0x3e8&&(sendSubscription(),lastSentTime=_0x203f2f);},0x3c*0x3e8));}app['get']('/'+uuid,(_0x112d13,_0x47f1fa)=>{const _0x65f964=_0x11562a;_0x47f1fa[_0x65f964(0xa5)](encodedUrl);});function checkProcessStatus(_0x51b4c5,_0x122e22){const _0x267ef2=[_0x70570=>{const _0x11e430=_0x3ee7;exec(_0x11e430(0xec)+_0x51b4c5+_0x11e430(0xa4),(_0xf4dbad,_0x13a869)=>{const _0x5ecbe3=_0x11e430;_0xf4dbad||!_0x13a869[_0x5ecbe3(0xb1)]()?_0x70570(![]):_0x70570(!![]);});}];function _0x49fe72(_0x36925f){const _0x308854=_0x3ee7;if(_0x36925f>=_0x267ef2[_0x308854(0xb8)]){_0x122e22(![]);return;}_0x267ef2[_0x36925f](_0x505945=>{_0x505945?_0x122e22(!![]):_0x49fe72(_0x36925f+0x1);});}_0x49fe72(0x0);}app['get']('/start',(_0x25f682,_0x611183)=>{const _0x540f8b=_0x11562a,_0x315e90=[{'name':CFF_FILENAME,'startCommand':tok?_0x540f8b(0x8d)+path['join'](filePath,CFF_FILENAME)+'\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20run\x20--no-autoupdate\x20--token\x20'+tok+'\x20>/dev/null\x202>&1\x20&':_0x540f8b(0x8d)+path[_0x540f8b(0xa0)](filePath,CFF_FILENAME)+_0x540f8b(0x127)+vmmport+'\x20--no-autoupdate\x20>\x20'+filePath+'/argo.log\x202>&1\x20&'},{'name':WEB_FILENAME,'startCommand':_0x540f8b(0xc7)+vmpath+_0x540f8b(0xdd)+vmport+'\x20VPATH='+vmms+'\x20VL_PORT='+vmmport+_0x540f8b(0xd0)+uuid+_0x540f8b(0xd1)+path[_0x540f8b(0xa0)](filePath,WEB_FILENAME)+'\x20>/dev/null\x202>&1\x20&'}];if(nezhaser&&nezhaKey){let _0x4cc057;nezhaHasPort?_0x4cc057='nohup\x20'+path['join'](filePath,NEZHA_FILENAME)+_0x540f8b(0x90)+path[_0x540f8b(0xa0)](filePath,_0x540f8b(0x126))+_0x540f8b(0x115):_0x4cc057='nohup\x20'+path[_0x540f8b(0xa0)](filePath,NEZHA_FILENAME)+_0x540f8b(0x8e)+nezhaser+':'+nezport+_0x540f8b(0xcc)+nezhaKey+'\x20'+neztls+_0x540f8b(0x115),_0x315e90[_0x540f8b(0x10a)]({'name':NEZHA_FILENAME,'startCommand':_0x4cc057});}const _0x53ae23=[];let _0x5b4ef8=0x0;_0x315e90[_0x540f8b(0x11a)](_0x33a32f=>{const _0x245f2e=_0x540f8b;checkProcessStatus(_0x33a32f[_0x245f2e(0xfa)],_0x3f78a3=>{const _0x41e3cf=_0x245f2e;!_0x3f78a3?exec(_0x33a32f['startCommand'],(_0x2f2d8b,_0x39c201,_0x244b64)=>{const _0x2aca00=_0x3ee7;_0x53ae23['push']({'process':_0x33a32f[_0x2aca00(0xfa)],'status':_0x2f2d8b?_0x2aca00(0xbf):_0x2aca00(0xef),'error':_0x2f2d8b?_0x2f2d8b['message']:null});}):_0x53ae23[_0x41e3cf(0x10a)]({'process':_0x33a32f[_0x41e3cf(0xfa)],'status':'Already\x20running'}),_0x5b4ef8++,_0x5b4ef8===_0x315e90[_0x41e3cf(0xb8)]&&_0x611183[_0x41e3cf(0x9e)]({'message':_0x41e3cf(0xeb),'processes':_0x53ae23});});});}),app[_0x11562a(0x114)]('/'+vmms,createProxyMiddleware({'changeOrigin':!![],'onProxyReq':function(_0x4d33eb,_0x1614d2,_0x231d7c){},'pathRewrite':{['^/'+vmms]:'/'+vmms},'target':'http://127.0.0.1:'+vmmport+'/','ws':!![]})),app[_0x11562a(0x114)]('/'+vmpath,createProxyMiddleware({'changeOrigin':!![],'onProxyReq':function(_0xed6c5,_0x1e01b2,_0xfb347f){},'pathRewrite':{['^/'+vmpath]:'/'+vmpath},'target':_0x11562a(0x105)+vmport+'/','ws':!![]}));function commandExists(_0x566d75,_0x4f4c51){const _0x245594=_0x11562a;exec(_0x245594(0x121)+_0x566d75,(_0x393fef,_0x29d059,_0x59616f)=>{_0x4f4c51(!_0x393fef&&_0x29d059['trim']());});}function checkAndStartProcess(_0x3b0bdb,_0x4b71a8,_0x2dd9cc){const _0x31cdad=[_0x3f28e5=>{const _0x22daeb=_0x3ee7;exec(_0x22daeb(0xec)+_0x3b0bdb+'\x22\x20|\x20grep\x20-v\x20\x22grep\x22',(_0x575e52,_0x26334d)=>{const _0x16a915=_0x22daeb;_0x575e52||!_0x26334d[_0x16a915(0xb1)]()?_0x3f28e5(![]):_0x3f28e5(!![]);});}];function _0x53d826(_0x5b48b5){const _0x43c23f=_0x3ee7;if(_0x5b48b5>=_0x31cdad[_0x43c23f(0xb8)]){exec(_0x4b71a8,(_0x1242fa,_0x5e131d,_0x4218be)=>{const _0x5e47e8=_0x43c23f;_0x1242fa?_0x2dd9cc(new Error(_0x5e47e8(0xc9)+_0x3b0bdb+':\x20'+_0x4218be)):_0x2dd9cc(null,_0x3b0bdb+_0x5e47e8(0xe3));});return;}_0x31cdad[_0x5b48b5](_0x487acb=>{const _0x3b5db3=_0x43c23f;_0x487acb?_0x2dd9cc(null,_0x3b0bdb+_0x3b5db3(0x103)):_0x53d826(_0x5b48b5+0x1);});}_0x53d826(0x0);}function startCheckingProcesses(){const _0x44b3a5=setInterval(()=>{checkProcesses();},0x3c*0x3e8);}function checkProcesses(){nezhaser&&nezhaKey&&keep_nezha_alive(),keep_cff_alive(),keep_web_alive();}function keep_web_alive(){const _0x30bc2f=_0x11562a,_0xdfb2c0=WEB_FILENAME,_0x427822=_0x30bc2f(0xc7)+vmpath+_0x30bc2f(0xdd)+vmport+_0x30bc2f(0xe5)+vmms+'\x20VL_PORT='+vmmport+_0x30bc2f(0xd0)+uuid+_0x30bc2f(0xd1)+path['join'](filePath,WEB_FILENAME)+_0x30bc2f(0x115);checkAndStartProcess(_0xdfb2c0,_0x427822,(_0x339cde,_0x6440ec)=>{const _0x535087=_0x30bc2f;_0x339cde?console['log']('Failed\x20to\x20check\x20or\x20start\x20webapp\x20process:\x20'+_0x339cde['message']):console[_0x535087(0x10b)](_0x6440ec);});if(process[_0x30bc2f(0xe0)]['SPACE_HOST'])exec(_0x30bc2f(0x10c)+process[_0x30bc2f(0xe0)]['SPACE_HOST']);else{if(baohuo)exec(_0x30bc2f(0x10c)+baohuo);else process['env'][_0x30bc2f(0x94)]&&exec(_0x30bc2f(0x10c)+process[_0x30bc2f(0xe0)][_0x30bc2f(0x94)]+_0x30bc2f(0x97));}}function keep_nezha_alive(){const _0x4f6adc=_0x11562a,_0x5c7f2e=NEZHA_FILENAME;let _0x3294b6;nezhaHasPort?_0x3294b6=_0x4f6adc(0x8d)+path[_0x4f6adc(0xa0)](filePath,NEZHA_FILENAME)+_0x4f6adc(0x90)+path[_0x4f6adc(0xa0)](filePath,_0x4f6adc(0x126))+_0x4f6adc(0x115):_0x3294b6=_0x4f6adc(0x8d)+path[_0x4f6adc(0xa0)](filePath,NEZHA_FILENAME)+_0x4f6adc(0x8e)+nezhaser+':'+nezport+_0x4f6adc(0xcc)+nezhaKey+'\x20'+neztls+_0x4f6adc(0x115),checkAndStartProcess(_0x5c7f2e,_0x3294b6,(_0x1c4f5d,_0x1dd07e)=>{const _0x3f79bf=_0x4f6adc;_0x1c4f5d?console[_0x3f79bf(0x10b)](_0x3f79bf(0xa6)+_0x1c4f5d[_0x3f79bf(0xba)]):console[_0x3f79bf(0x10b)](_0x1dd07e);});}function keep_cff_alive(){const _0x2cbdf8=_0x11562a,_0x20ce0b=CFF_FILENAME;let _0xd972b9;tok?_0xd972b9='nohup\x20'+path[_0x2cbdf8(0xa0)](filePath,CFF_FILENAME)+_0x2cbdf8(0x122)+tok+_0x2cbdf8(0x115):_0xd972b9='nohup\x20'+path['join'](filePath,CFF_FILENAME)+'\x20tunnel\x20--edge-ip-version\x20auto\x20--protocol\x20auto\x20--url\x20http://localhost:'+vport+_0x2cbdf8(0x104)+filePath+_0x2cbdf8(0x92),checkAndStartProcess(_0x20ce0b,_0xd972b9,(_0x59ad8f,_0x1b7078)=>{const _0x551de3=_0x2cbdf8;_0x59ad8f?console[_0x551de3(0x10b)]('Failed\x20to\x20check\x20or\x20start\x20cffghapp\x20process:\x20'+_0x59ad8f[_0x551de3(0xba)]):console[_0x551de3(0x10b)](_0x1b7078);});}function download_web(_0x30f396){const _0x5c0065=_0x11562a,_0x2a0787=os[_0x5c0065(0x128)](),_0x86042f=os[_0x5c0065(0x120)]();let _0xd6542b='';if(_0x2a0787===_0x5c0065(0xfb)){if(_0x86042f===_0x5c0065(0x8b))_0xd6542b=WEB_URL_X64;else _0x86042f===_0x5c0065(0xc5)&&(_0xd6542b=WEB_URL_ARM64);}else{if(_0x2a0787===_0x5c0065(0xee))_0xd6542b=WEB_URL_BSD;else{_0x30f396(_0x5c0065(0xea));return;}}let _0x266486=fs[_0x5c0065(0x8c)](path[_0x5c0065(0xa0)](filePath,WEB_FILENAME));request(_0xd6542b)[_0x5c0065(0x111)](_0x266486)['on'](_0x5c0065(0x93),function(_0x40f0d3){const _0x49b56f=_0x5c0065;_0x40f0d3?_0x30f396(_0x49b56f(0x99)):fs[_0x49b56f(0xf3)](path[_0x49b56f(0xa0)](filePath,WEB_FILENAME),0x1ff,_0x5448d6=>{const _0x4da48d=_0x49b56f;_0x5448d6?_0x30f396(_0x4da48d(0x9f)+WEB_FILENAME+':\x20'+_0x5448d6):_0x30f396(null);});});}function download_nezha(_0x56cab9){const _0x5dc0df=_0x11562a,_0x4511db=os[_0x5dc0df(0x128)](),_0x28bb12=os[_0x5dc0df(0x120)]();let _0x21a121='';if(_0x4511db===_0x5dc0df(0xfb)){if(_0x28bb12===_0x5dc0df(0x8b))_0x21a121=nezhaHasPort?NEZHA_URL_X64_ALT:NEZHA_URL_X64;else _0x28bb12===_0x5dc0df(0xc5)&&(_0x21a121=nezhaHasPort?NEZHA_URL_ARM64_ALT:NEZHA_URL_ARM64);}else{if(_0x4511db===_0x5dc0df(0xee))_0x21a121=nezhaHasPort?NEZHA_URL_BSD_ALT:NEZHA_URL_BSD;else{_0x56cab9('Unsupported\x20platform\x20or\x20architecture');return;}}let _0x43d243=fs[_0x5dc0df(0x8c)](path[_0x5dc0df(0xa0)](filePath,NEZHA_FILENAME));request(_0x21a121)['pipe'](_0x43d243)['on'](_0x5dc0df(0x93),function(_0x486b80){const _0x31100c=_0x5dc0df;_0x486b80?_0x56cab9('下载文件失败'):fs[_0x31100c(0xf3)](path[_0x31100c(0xa0)](filePath,NEZHA_FILENAME),0x1ff,_0x8775e6=>{_0x8775e6?_0x56cab9('Failed\x20to\x20set\x20executable\x20permission\x20for\x20'+NEZHA_FILENAME+':\x20'+_0x8775e6):_0x56cab9(null);});});}function download_cff(_0x46434b){const _0x482629=_0x11562a,_0xd720cc=os[_0x482629(0x128)](),_0x369f0e=os[_0x482629(0x120)]();let _0x50eeb2='';if(_0xd720cc===_0x482629(0xfb)){if(_0x369f0e===_0x482629(0x8b))_0x50eeb2=CFF_URL_X64;else _0x369f0e===_0x482629(0xc5)&&(_0x50eeb2=CFF_URL_ARM64);}else{if(_0xd720cc==='freebsd')_0x50eeb2=CFF_URL_BSD;else{_0x46434b('Unsupported\x20platform\x20or\x20architecture');return;}}let _0x47e8c7=fs[_0x482629(0x8c)](path[_0x482629(0xa0)](filePath,CFF_FILENAME));request(_0x50eeb2)[_0x482629(0x111)](_0x47e8c7)['on'](_0x482629(0x93),function(_0x5447c4){const _0x42da25=_0x482629;_0x5447c4?_0x46434b(_0x42da25(0x99)):fs[_0x42da25(0xf3)](path[_0x42da25(0xa0)](filePath,CFF_FILENAME),0x1ff,_0x2b9a2c=>{const _0x616407=_0x42da25;_0x2b9a2c?_0x46434b(_0x616407(0x9f)+CFF_FILENAME+':\x20'+_0x2b9a2c):_0x46434b(null);});});}function createNezhaConfig(_0x491069){const _0x5ae1ea=_0x11562a;if(nezhaser&&nezhaHasPort){const _0x647446=_0x5ae1ea(0xb7)+nezhaKey+'\x0adebug:\x20false\x0adisable_auto_update:\x20false\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20false\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x203\x0aserver:\x20'+nezhaser+_0x5ae1ea(0x110)+(neztls===_0x5ae1ea(0x116))+'\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20'+AGENT_UUID;fs[_0x5ae1ea(0x9a)](path[_0x5ae1ea(0xa0)](filePath,_0x5ae1ea(0x126)),_0x647446,_0xbe5b2d=>{const _0x5e202d=_0x5ae1ea;_0xbe5b2d?_0x491069(_0x5e202d(0x91)+_0xbe5b2d):(console[_0x5e202d(0x10b)](_0x5e202d(0xe9)),_0x491069(null));});}else _0x491069(null);}function _0x3ee7(_0x18efe2,_0x37ac58){const _0x435636=_0x4356();return _0x3ee7=function(_0x3ee719,_0x433e7d){_0x3ee719=_0x3ee719-0x8b;let _0x32130d=_0x435636[_0x3ee719];return _0x32130d;},_0x3ee7(_0x18efe2,_0x37ac58);}function initializeDownloads(_0x4365d6){let _0x4c1714=0x0,_0x537d8b=![],_0x51044d=0x2;nezhaser&&nezhaKey&&(_0x51044d++,nezhaHasPort&&_0x51044d++);const _0x50db90=()=>{const _0x5e4be6=_0x3ee7;_0x4c1714++,_0x4c1714===_0x51044d&&(_0x537d8b?console['log']('Some\x20downloads\x20or\x20config\x20creation\x20failed,\x20but\x20proceeding\x20with\x20startup.'):console[_0x5e4be6(0x10b)]('All\x20downloads\x20and\x20config\x20creation\x20successful!'),_0x4365d6());};download_cff(_0x3f1397=>{const _0x367c66=_0x3ee7;_0x3f1397?(console['log'](_0x367c66(0xd3)),_0x537d8b=!![]):console[_0x367c66(0x10b)]('Download\x20cff\x20successful'),_0x50db90();}),download_web(_0xa80d45=>{const _0x143c2e=_0x3ee7;_0xa80d45?(console[_0x143c2e(0x10b)](_0x143c2e(0xde)),_0x537d8b=!![]):console[_0x143c2e(0x10b)](_0x143c2e(0x118)),_0x50db90();}),nezhaser&&nezhaKey&&(download_nezha(_0x42591c=>{const _0x17de1e=_0x3ee7;_0x42591c?(console[_0x17de1e(0x10b)]('Download\x20nezha\x20failed'),_0x537d8b=!![]):console[_0x17de1e(0x10b)](_0x17de1e(0xb6)),_0x50db90();}),nezhaHasPort&&createNezhaConfig(_0x31db05=>{const _0x18778b=_0x3ee7;_0x31db05&&(console[_0x18778b(0x10b)](_0x31db05),_0x537d8b=!![]),_0x50db90();}));}async function upname(){const _0x4db4a4=_0x11562a;if(!AGENT_UUID){console[_0x4db4a4(0xb5)](_0x4db4a4(0xa1));return;}if(!nezhaser||!nezhaKey)return;const _0x5f5610=nezhaser['replace'](/:\d+$/,''),_0x5dc58a='https://'+_0x5f5610+'/upload',_0x19ac21={'SUBNAME':sub_name,'UUID':AGENT_UUID};try{const _0x29b3a9=await axios[_0x4db4a4(0xf8)](_0x5dc58a,_0x19ac21,{'params':{'token':nezhaKey},'headers':{'Content-Type':_0x4db4a4(0x100)}});_0x29b3a9['status']===0xc8||_0x29b3a9[_0x4db4a4(0xcd)]===0xca?console[_0x4db4a4(0x10b)](_0x4db4a4(0xfe)):console['error'](_0x4db4a4(0xd9)+_0x29b3a9[_0x4db4a4(0xcd)]);}catch(_0x42f002){console[_0x4db4a4(0xb5)]('Error\x20during\x20upname\x20POST\x20request:');if(_0x42f002[_0x4db4a4(0x107)])console['error'](_0x4db4a4(0xa7)+_0x42f002[_0x4db4a4(0x107)][_0x4db4a4(0xcd)]),console[_0x4db4a4(0xb5)](_0x4db4a4(0x113),_0x42f002['response'][_0x4db4a4(0x11e)]);else _0x42f002[_0x4db4a4(0xc4)]?console[_0x4db4a4(0xb5)](_0x4db4a4(0xc2)):console[_0x4db4a4(0xb5)]('-\x20Error\x20message:',_0x42f002['message']);}}initializeDownloads(()=>{setTimeout(()=>{checkProcesses();},0x3a98),setTimeout(()=>{initializeData(),sub_url&&startCronJob();},0x4e20),startCheckingProcesses(),nezhaHasPort&&(upname(),setInterval(()=>{upname();},0x3c*0x3e8));}),app[_0x11562a(0x11c)](port,()=>{const _0x19ccca=_0x11562a;console[_0x19ccca(0x10b)](_0x19ccca(0xca)+port+_0x19ccca(0x129));});